---
title: IntoDrama Chatbot
emoji: 💬
colorFrom: blue
colorTo: indigo
sdk: docker
pinned: false
---

# IntoDrama - 드라마 캐릭터 AI 챗봇

드라마 캐릭터와 대화할 수 있는 AI 챗봇 애플리케이션입니다. Google Gemini AI를 활용하여 드라마 캐릭터의 페르소나를 구현하고, 사용자와 자연스러운 대화를 제공합니다.

---

## 🎯 주요 기능

### 💬 대화 기능

#### 1:1 대화
- **단일 캐릭터와의 개인 대화**: 한 명의 드라마 캐릭터와 깊이 있는 1:1 대화를 나눌 수 있습니다
- **페르소나 기반 대화**: 각 캐릭터의 고유한 성격, 말투, 배경 스토리를 반영한 자연스러운 대화
- **행동 표현 지원**: 대화 입력 시 행동과 대사를 구분하여 입력 가능 (예: "(웃으며) 안녕하세요", "(한숨을 쉬며) 그렇구나")
- **실시간 타이핑 효과**: AI 응답이 타이핑되는 것처럼 표시되어 생동감 있는 대화 경험 제공
- **캐릭터 기억 시스템**: 이전 대화 내용을 기억하고 다음 대화에 반영하여 장기적인 관계 형성
- **대화 맥락 유지**: 대화 흐름을 자연스럽게 이어가며 캐릭터의 일관성 있는 반응 제공

#### 1:2 멀티채팅
- **2명의 캐릭터와 동시 대화**: 사용자는 최대 2명의 캐릭터와 동시에 대화할 수 있습니다 (1:1 또는 1:2 대화만 지원)
- **캐릭터 간 상호작용**: 두 캐릭터가 서로 대화하며 사용자와도 자연스럽게 소통하는 3자 대화 형식
- **관계 기반 대화**: 캐릭터들 간의 드라마 내 관계를 반영한 자연스러운 상호작용
- **캐릭터별 구분**: 각 메시지에 캐릭터 이름이 표시되어 누가 말하는지 명확히 구분
- **대화 흐름 관리**: 여러 캐릭터가 참여하는 복잡한 대화 상황도 자연스럽게 처리
- **시각적 구분**: 1:2 대화 시 대화 목록에서 두 캐릭터의 프로필 사진이 대각선으로 겹쳐 표시

#### 토론 모드
- **2명의 캐릭터 토론**: 정확히 2명의 캐릭터가 선택된 상태에서 특정 주제에 대해 토론을 진행합니다
- **토론 주제 선택**: 미리 준비된 토론 주제 중 선택하거나 직접 주제를 입력할 수 있습니다
- **토론 스타일**: 균형잡힌(balanced), 공격적(aggressive), 협력적(collaborative) 등 다양한 토론 스타일을 선택할 수 있습니다
- **라운드별 진행**: 토론이 여러 라운드로 나뉘어 진행되며, 각 라운드마다 캐릭터들이 의견을 제시합니다
- **사용자 개입 기능**: 토론 중간에 사용자가 직접 의견을 제시하고 토론에 참여할 수 있습니다
  - **라운드 3 이상**: 3라운드부터 사용자가 토론에 개입할 수 있는 패널이 표시됩니다
  - **입장 선택**: 미리 준비된 입장 중 하나를 선택하거나 직접 의견을 입력할 수 있습니다
  - **자동 진행**: 사용자가 개입하면 자동으로 다음 라운드로 진행됩니다
- **시각적 배치**: 각 캐릭터가 화면 왼쪽/오른쪽에 배치되어 토론의 대립 구조를 시각적으로 표현
- **토론 요약**: 토론 종료 시 각 라운드의 요약과 전체 토론 내용을 정리하여 제공
- **감상평 제공**: 토론 종료 후 각 캐릭터가 자신의 입장과 감상을 정리한 메시지를 제공
- **일반 채팅 전환**: 토론 모드 종료 후 일반 채팅으로 자연스럽게 전환 가능
- **토론 히스토리 제외**: 토론 내용은 일반 대화 히스토리에서 제외되어 페르소나에 영향을 주지 않습니다

#### 대화 저장 및 관리
- **대화 보관함 (내 대화 보관함)**
  - 사용자가 직접 "서버에 저장" 버튼을 눌러 저장한 전체 대화만 표시됩니다 (is_manual=1)
  - 대화 제목을 직접 입력하거나 자동 생성된 제목으로 저장 가능
  - 저장된 대화 목록에서 상대 시간 표시 (방금 전, n일 전, n주 전 등)
  - 저장된 대화를 클릭하여 언제든지 다시 불러올 수 있습니다
  - 대화 삭제 기능으로 불필요한 대화를 정리할 수 있습니다
  - 1:1 대화는 단일 프로필 사진, 1:2 대화는 두 캐릭터의 프로필 사진이 대각선으로 겹쳐 표시됩니다
  - 최신순 정렬: 저장된 대화는 최신순으로 정렬되어 표시됩니다

- **자동 저장 시스템**
  - 로그인한 사용자의 경우 모든 대화가 자동으로 서버에 저장됩니다 (is_manual=0)
  - 자동 저장된 대화는 통계 및 분석에 활용되지만 대화 보관함에는 표시되지 않습니다
  - 대사 저장 시 해당 대화가 자동으로 저장되어 나중에 추적할 수 있습니다 (is_manual_quote=1)

- **저장된 대사 목록**
  - 좋아하는 메시지를 더블클릭하면 하트 아이콘이 표시되며 자동으로 저장됩니다
  - 저장된 대사는 별도의 "저장된 대사 목록" 페이지에서 관리됩니다
  - 저장된 대사는 대화 보관함에 나타나지 않으며, 오직 저장된 대사 목록에서만 확인 가능합니다
  - 각 저장된 대사에는 해당 대사가 포함된 전체 대화로 이동할 수 있는 "대화 흐름 추적하기" 버튼이 제공됩니다
  - 저장된 대사에는 캐릭터 이름, 대화 날짜, 대사 내용이 표시됩니다

- **대화 흐름 추적하기**
  - 저장된 대사 목록에서 "대화 흐름 추적하기" 버튼을 클릭하면 해당 대사가 포함된 전체 대화가 표시됩니다
  - 저장된 대사는 노란색 글로우 효과로 하이라이트되어 쉽게 찾을 수 있습니다
  - 대사 저장 시 자동으로 전체 대화가 서버에 저장되어 나중에 추적할 수 있습니다
  - 대화의 전체 맥락을 파악하며 저장된 대사가 어떤 상황에서 나온 것인지 확인 가능합니다

### 📊 통계 및 분석

#### 주간 통계
- **이번주 대화 요약**: 현재 주(월요일부터 오늘까지)의 대화 활동을 한눈에 확인
- **캐릭터별 활동량**: 이번주에 가장 많이 대화한 캐릭터 TOP 3를 순위와 함께 표시
- **상세 통계 정보**: 각 캐릭터별 대화 횟수, 메시지 수, 대화 시간 등 구체적인 수치 제공
- **시각적 표현**: 그래프와 차트를 통해 데이터를 직관적으로 이해할 수 있도록 시각화
- **랭킹 시스템**: 1위, 2위, 3위 캐릭터를 뱃지와 함께 표시하여 한눈에 파악 가능

#### 주간 리캡
- **월별 주간 대화 요약**: 6개월간의 대화 기록을 월별로 나누어 확인할 수 있습니다
- **주별 활동 시각화**: 각 주의 대화 활동량을 시각적으로 표현하여 패턴 파악 가능
- **캐릭터 랭킹**: 해당 주에 가장 많이 대화한 캐릭터 TOP 3를 순위와 함께 표시
- **현재 주 하이라이트**: 이번주 대화 활동을 특별히 강조하여 표시
- **"이번주" 뱃지**: 현재 주를 명확히 구분할 수 있는 뱃지 제공
- **과거 데이터 탐색**: 최근 6개월간의 대화 패턴을 시간순으로 탐색 가능

#### 심리 리포트
- **AI 기반 심리 분석**: 대화 내용을 AI가 분석하여 사용자의 심리 상태를 파악합니다
- **감정 상태 분석**: 대화에서 드러나는 감정 상태를 분석하고 시각화합니다
  - **로맨스 점수**: 대화에서 드러나는 로맨틱한 감정의 강도를 분석합니다
  - **위로 점수**: 위로나 공감이 필요한 감정의 강도를 분석합니다
  - **갈등 점수**: 갈등이나 스트레스가 있는 감정의 강도를 분석합니다
- **주요 감정 결정**: 분석된 감정 점수를 바탕으로 주요 감정(dominant mood)을 결정합니다
- **키워드 분석**: 대화에서 자주 사용된 키워드를 추출하여 감정 패턴을 파악합니다
- **말투 분석**: 사용자의 말투 스타일을 분석하여 대화 패턴을 이해합니다
- **관계 패턴 분석**: 캐릭터와의 관계 패턴, 대화 스타일, 선호도 등을 분석합니다
- **에피소드별 리포트**: 특정 대화 세션을 에피소드로 저장하고 해당 에피소드의 리포트를 생성합니다
- **리포트 저장 및 관리**: 생성된 리포트를 저장하여 나중에 다시 확인할 수 있습니다
- **리포트 이미지 생성**: 리포트를 이미지로 변환하여 저장하거나 공유할 수 있습니다
- **감정 타임라인**: 대화 시간순으로 감정 변화를 시각화하여 타임라인으로 확인할 수 있습니다
- **인사이트 제공**: 대화 패턴을 통해 사용자의 심리적 특성과 관계 형성 방식을 인사이트로 제공

### 📝 일기 기능 (마음 기록 노트)

#### 감정 일기 자동 생성
- **AI 기반 일기 생성**: 대화 내용을 AI가 분석하여 감정 일기를 자동으로 생성합니다
- **대화 기반 생성**: 현재 대화 세션의 메시지를 분석하여 일기를 생성합니다
- **키워드 기반 생성**: 사용자가 직접 키워드를 입력하여 일기를 생성할 수 있습니다
- **직접 작성**: AI 생성 없이 사용자가 직접 일기를 작성할 수도 있습니다
- **감정 상태 반영**: 대화에서 드러난 사용자의 감정 상태를 일기 내용에 자연스럽게 반영
- **감정 태그**: 일기에 감정 태그(기쁨, 슬픔, 화남, 불안, 평온 등)를 추가할 수 있습니다
- **대화 경험 정리**: 캐릭터와의 대화 경험을 일기 형식으로 정리하여 기록으로 남깁니다
- **날짜별 관리**: 각 날짜별로 일기를 작성하고 저장하여 시간순으로 관리할 수 있습니다
- **일기 목록 조회**: 작성한 일기 목록을 날짜순으로 확인하고 다시 읽을 수 있습니다
- **일기 삭제**: 불필요한 일기를 삭제하여 관리할 수 있습니다
- **자연스러운 문체**: 일기 형식에 맞는 자연스러운 문체로 작성되어 읽기 편합니다
- **일기 제목 자동 생성**: 일기 내용을 바탕으로 적절한 제목을 자동으로 생성합니다

#### 날씨 연동
- **실제 날씨 정보**: OpenWeatherMap API를 통해 실제 날씨 정보를 가져옵니다
- **자동 날씨 기록**: 일기 작성 시 해당 날짜의 날씨 정보가 자동으로 기록됩니다
- **날씨 반영**: 일기 내용에 날씨 정보가 자연스럽게 반영되어 더 생생한 기록이 됩니다
- **날씨 아이콘**: 날씨 상태를 아이콘으로 표시하여 한눈에 파악 가능합니다
- **날짜 선택**: 달력을 통해 원하는 날짜를 선택하여 해당 날짜의 일기를 작성할 수 있습니다
- **미래 날짜 제한**: 오늘 이후의 날짜는 선택할 수 없도록 제한되어 있습니다

### 🎁 캐릭터 상호작용

#### 성향 지도 (캐릭터 성향 지도)
- **2D 좌표계 시각화**: 캐릭터들의 성향을 2차원 좌표계로 시각화하여 한눈에 비교할 수 있습니다
- **성향 축**: 따뜻함/차가움(가로축), 현실적/이상적(세로축) 두 가지 차원으로 캐릭터를 배치합니다
  - **따뜻함/차가움 (warmth)**: 0.0(매우 차가움) ~ 1.0(매우 따뜻함)
  - **현실적/이상적 (realism)**: 0.0(매우 이상적) ~ 1.0(매우 현실적)
- **AI 기반 성향 분석**: Gemini AI를 활용하여 캐릭터의 페르소나, 대사, 인터넷 검색 정보를 종합 분석합니다
- **캐릭터 포인트**: 각 캐릭터가 지도 위의 특정 위치에 점으로 표시되어 성향을 직관적으로 파악 가능
- **관계 시각화**: 캐릭터들 간의 성향 차이와 유사성을 지도상의 거리로 표현합니다
- **인터랙티브 지도**: 지도를 통해 캐릭터들의 성격 특성을 쉽게 이해하고 비교할 수 있습니다
- **실시간 보정**: 사용자와의 대화 기록을 분석하여 캐릭터 성향을 약간 보정합니다 (20% 가중치)
- **성향 캐싱**: 서버 시작 시 모든 캐릭터의 성향을 미리 계산하여 캐시에 저장합니다
- **데이터베이스 저장**: 계산된 성향 데이터를 데이터베이스에 저장하여 재사용합니다

#### 캐릭터 기억 시스템
- **대화 기억**: 캐릭터가 사용자와의 이전 대화 내용을 기억하고 다음 대화에 반영합니다
- **기억 타입**: 감정(emotion), 이벤트(event), 선호도(preference), 관계(relationship) 등 다양한 타입의 기억을 저장합니다
- **중요도 기반 기억**: 중요한 대화나 감정적 이벤트를 우선적으로 기억하여 더 의미 있는 대화 생성 (중요도 1-10)
- **기억 추출**: AI가 대화 내용에서 중요한 정보를 자동으로 추출하여 기억으로 저장합니다
- **기억 참조**: 관련된 과거 대화를 자동으로 참조하여 더 자연스럽고 일관성 있는 응답 생성
- **선호도 학습**: 사용자의 선호도, 관심사, 대화 스타일 등을 학습하여 점점 더 개인화된 대화 제공
- **맥락 유지**: 이전 대화의 맥락을 유지하여 연속성 있는 대화 경험을 제공합니다
- **장기 관계 형성**: 시간이 지날수록 캐릭터와의 관계가 깊어지고, 더 개인적인 대화가 가능해집니다
- **기억 업데이트**: 기억이 참조될 때마다 last_referenced 시간이 업데이트되어 최근성 반영
- **토큰 최적화**: 대화 히스토리가 길어질 때 토큰 제한을 고려하여 중요한 기억만 참조합니다

### 🎨 사용자 경험

#### 실시간 타이핑 효과
- **타이핑 애니메이션**: AI 응답이 한 글자씩 타이핑되는 것처럼 표시되어 생동감 있는 대화 경험 제공
- **설정 가능**: 설정 메뉴에서 타이핑 효과를 ON/OFF로 전환할 수 있어 선호에 맞게 조정 가능
- **자연스러운 흐름**: 타이핑 효과로 인해 대화가 더 자연스럽고 실시간으로 진행되는 느낌을 줍니다
- **읽기 속도 조절**: 타이핑 효과를 통해 메시지를 천천히 읽을 수 있어 이해도 향상

#### 메시지 캡처 및 공유
- **선택적 캡처**: 원하는 메시지만 선택하여 이미지로 캡처할 수 있습니다
- **고해상도 이미지**: HTML2Canvas를 사용하여 고해상도의 이미지를 생성합니다
- **SNS 공유**: 캡처한 대화 이미지를 SNS에 공유하거나 저장하여 친구들과 공유 가능
- **대화 기록 보존**: 특별한 대화를 이미지로 저장하여 오랫동안 보관할 수 있습니다

#### 소설 형식 변환
- **서사적 문체 변환**: 대화 내용을 소설 형식의 서사적 문체로 자동 변환합니다
- **자연스러운 재구성**: 대화를 읽기 편한 소설 형식으로 재구성하여 이야기처럼 읽을 수 있습니다
- **텍스트 파일 저장**: 변환된 소설 형식의 텍스트를 파일로 저장하여 보관 가능
- **스토리텔링**: 단순한 대화가 하나의 이야기로 변환되어 더욱 흥미롭게 읽을 수 있습니다

#### 한국어 조사 자동 처리
- **지능형 조사 선택**: 받침 유무에 따라 '와/과', '이/가', '을/를', '은/는' 등을 자동으로 올바르게 선택
- **자연스러운 문장**: 한국어 문법에 맞는 자연스러운 문장을 자동으로 생성합니다
- **캐릭터 이름 처리**: 여러 캐릭터 이름을 연결할 때도 각 이름에 맞는 조사를 자동으로 적용
- **오류 방지**: 수동으로 조사를 입력할 때 발생할 수 있는 오류를 자동으로 방지합니다

#### 프로필 설정
- **닉네임 변경**: 사용자 닉네임을 자유롭게 변경할 수 있으며, 대화에서 캐릭터가 이 닉네임을 사용합니다
- **프로필 사진**: 프로필 사진을 업로드하여 개인화된 프로필을 만들 수 있습니다
- **프로필 미리보기**: 사진을 업로드하기 전에 미리보기를 통해 확인 가능합니다
- **간편한 변경**: "변경" 버튼을 통해 쉽게 프로필 사진을 교체할 수 있습니다

#### 음성 입력 기능
- **음성 인식**: 브라우저의 Web Speech API를 활용하여 음성으로 메시지를 입력할 수 있습니다
- **실시간 음성 감정 분석**: 음성 입력 중 실시간으로 음성의 톤과 감정을 분석합니다
- **감정 감지**: 음성의 피치, 볼륨, 주파수를 분석하여 기쁨, 슬픔, 화남, 중립 등의 감정을 감지합니다
- **감정 표시**: 음성 입력 중 감지된 감정과 신뢰도를 실시간으로 표시합니다
- **감정 이모지**: 감지된 감정에 맞는 이모지를 메시지에 자동으로 추가합니다
- **음성 입력 중지**: 음성 입력 버튼을 다시 클릭하거나 말하기를 멈추면 자동으로 인식이 종료됩니다
- **브라우저 호환성**: Chrome, Edge 등 Web Speech API를 지원하는 브라우저에서 사용 가능합니다

#### 교환일기 기능
- **캐릭터와의 편지 교환**: 일기를 작성하고 캐릭터에게 보내면, 캐릭터가 답장을 작성하여 돌려보냅니다
- **일기 작성**: 마음 기록 노트에서 일기를 작성한 후 "답장 받기" 옵션을 활성화하면 교환일기가 생성됩니다
- **자동 답장 생성**: AI가 캐릭터의 페르소나에 맞게 일기에 대한 답장을 자동으로 생성합니다
- **답장 우편함**: 캐릭터로부터 받은 답장은 별도의 "교환일기" 화면에서 확인할 수 있습니다
- **답장 대기 알림**: 답장이 작성 중일 때 실시간으로 알림이 표시됩니다
- **답장 자동 새로고침**: 답장 대기 중일 때 5초마다 자동으로 새로고침하여 새 답장을 확인합니다
- **답장 반응 기능**: 받은 답장에 좋아요, 감사, 사랑 등의 반응을 남길 수 있습니다
- **답장 삭제**: 불필요한 답장을 삭제하여 관리할 수 있습니다
- **오늘의 주제**: 매일 새로운 일기 주제를 제안받아 일기를 작성할 수 있습니다
- **예약 발송**: 원하는 시간에 일기를 자동으로 발송하도록 예약할 수 있습니다
- **답장 날짜 표시**: 답장이 도착한 날짜를 "오늘 도착", "어제 도착", "n일 전 도착" 형식으로 표시합니다

#### 음악 추천 기능
- **감정 기반 음악 추천**: 대화 내용을 분석하여 사용자의 감정 상태에 맞는 음악을 추천합니다
- **캐릭터 음악 추천**: 가장 많이 대화한 캐릭터가 사용자의 기분에 맞춰 음악을 추천하고 코멘트를 남깁니다
- **감정 분석**: 최근 7일간의 대화 기록을 분석하여 우울, 위로, 불면증, 한숨, 걱정, 응원, 희망, 그리움, 청춘, 막막함, 설렘, 행복, 용기, 현실, 고독, 사랑 등의 감정을 감지합니다
- **플레이리스트**: 다양한 감정에 맞는 음악 플레이리스트가 준비되어 있습니다
- **YouTube 링크**: 추천된 음악의 YouTube 링크를 제공하여 바로 들을 수 있습니다
- **캐릭터 코멘트**: 캐릭터의 말투로 음악 추천 코멘트를 생성하여 더욱 개인화된 경험을 제공합니다

#### 감정 기반 UI 변화
- **실시간 감정 감지**: 사용자와 캐릭터의 메시지를 실시간으로 분석하여 감정을 감지합니다
- **감정 타입**: 로맨스(romance), 위로(comfort), 갈등(conflict), 중립(neutral) 4가지 감정 타입을 감지합니다
- **배경색 변화**: 감지된 감정에 따라 채팅 화면의 배경색이 자동으로 변경됩니다
  - **로맨스 모드**: 따뜻한 핑크/베이지 그라데이션 배경과 부드러운 글로우 애니메이션
  - **위로 모드**: 따뜻한 노란색/베이지 그라데이션 배경과 페이드 애니메이션
  - **갈등 모드**: 붉은색 계열 그라데이션 배경과 펄스 애니메이션
  - **중립 모드**: 기본 브라운 톤 배경
- **말풍선 스타일 변화**: 감정에 따라 AI 메시지 말풍선의 색상과 스타일이 변경됩니다
- **고백 장면 효과**: 로맨스 감정이 강하고 고백 키워드("말해도 될까", "고백", "진심", "솔직히", "말하고 싶" 등)가 감지되면 특별한 고백 장면 모드가 활성화됩니다
  - **중앙 집중식 조명 효과**: 화면 중앙에서 퍼지는 방사형 조명 효과가 부드럽게 펄스되며, 핑크/베이지 그라데이션 배경이 적용됩니다
  - **말풍선 애니메이션**: 고백 장면에서는 모든 말풍선에 부드러운 펄스 애니메이션(subtlePulse)이 적용되어 살짝 흔들리는 듯한 효과가 나타납니다
  - **말풍선 스타일**: 사용자 말풍선은 살구 코랄 색상, AI 말풍선은 연한 코랄 색상으로 변경되어 로맨틱한 분위기를 연출합니다
  - **입력창 스타일**: 입력창도 반투명한 흰색 배경과 부드러운 블러 효과로 변경되어 고백 장면의 분위기에 맞춰집니다
  - **지속성**: 고백 키워드가 감지되면 로맨스 감정이 약해질 때까지 고백 장면 효과가 유지됩니다
- **감정 강도**: 감정의 강도(intensity)에 따라 배경색의 진하기와 애니메이션 효과가 달라집니다
- **플레이스홀더 변화**: 감정에 따라 입력창의 플레이스홀더 텍스트가 자동으로 변경됩니다
- **키워드 기반 감지**: 
  - 로맨스: "좋아해", "사랑", "설레", "보고싶어", "그리워" 등
  - 위로: "괜찮아", "힘내", "위로", "안아", "따뜻", "힘들어", "지치" 등
  - 갈등: "화나", "싫어", "미워", "답답", "실망" 등
- **지능형 감정 판단**: 취향을 묻는 질문은 로맨스로 오인식하지 않도록 특별 처리됩니다
- **감정 전환**: 대화 흐름에 따라 감정이 자연스럽게 전환되며, 이전 감정 상태를 고려하여 부드럽게 변화합니다

#### 기타 UX 기능
- **메시지 소리 알림**: 새 메시지가 도착할 때 소리 알림을 재생합니다 (설정에서 ON/OFF 가능)
- **랜덤 플레이스홀더**: 입력창에 표시되는 플레이스홀더 텍스트가 랜덤으로 변경되어 재미를 더합니다
- **대화 템플릿**: 미리 준비된 대화 템플릿을 선택하여 쉽게 대화를 시작할 수 있습니다
- **반응형 디자인**: 다양한 화면 크기(데스크톱, 태블릿, 모바일)에 최적화된 반응형 디자인
- **부드러운 스크롤**: 대화가 길어질 때 부드러운 스크롤 애니메이션으로 사용자 경험 향상
- **자동 스크롤**: 새 메시지가 도착하면 자동으로 화면 하단으로 스크롤되어 최신 메시지 확인 가능
- **저장된 대사 하이라이트**: 저장된 대사를 노란색 글로우 효과로 하이라이트하여 쉽게 찾을 수 있습니다
- **캐릭터 검색 및 필터**: 캐릭터 선택 화면에서 검색어나 드라마별로 필터링하여 원하는 캐릭터를 쉽게 찾을 수 있습니다
- **즐겨찾기 캐릭터**: 자주 대화하는 캐릭터를 즐겨찾기로 등록하여 빠르게 접근 가능합니다
- **대화 자동 저장**: 로그인한 사용자의 경우 대화가 자동으로 서버에 저장되어 통계 및 분석에 활용됩니다
- **대화 통계 추적**: 각 대화의 메시지 수, 대화 시간, 참여 캐릭터 등의 통계를 자동으로 추적합니다

---

## 프로젝트 구조

```
IntoDrama/
├── backend/                           # FastAPI 백엔드
│   ├── main.py                       # 메인 서버 파일 (FastAPI 앱 설정 및 라우터 등록)
│   ├── database.py                   # 데이터베이스 모델 및 세션 관리
│   ├── auth.py                       # 인증 관련 라우터 (회원가입, 로그인, JWT)
│   ├── chat.py                       # 채팅 관련 라우터 (1:1, 멀티채팅, 토론)
│   ├── diary.py                      # 일기 관련 라우터 (감정일기, 교환일기)
│   ├── features.py                   # 기타 기능 라우터 (성향지도, 음악추천, 심리리포트)
│   ├── ai_service.py                 # AI 서비스 모듈 (Gemini API 호출, 기억 추출 등)
│   ├── personas.py                   # 캐릭터 페르소나 데이터
│   ├── config.py                     # 설정 파일 (API 키, CORS 등)
│   ├── models/
│   │   └── schemas.py                # Pydantic 스키마 모델
│   ├── migrations/                   # 데이터베이스 마이그레이션
│   ├── requirements.txt              # Python 의존성
│   ├── drama_chat.db                 # SQLite 데이터베이스 파일
│   └── venv/                         # Python 가상환경
│
├── frontend/                         # React 프론트엔드
│   ├── src/
│   │   ├── components/               # React 컴포넌트
│   │   │   ├── CharacterSelectScreen.js    # 캐릭터 선택 화면
│   │   │   ├── CommonComponents.js         # 공통 컴포넌트 (타이핑 효과, 설정 등)
│   │   │   ├── ModalComponents.js          # 모달 컴포넌트 (일기, 성향지도 등)
│   │   │   ├── ProfileAndHistoryScreens.js # 프로필 및 대화 보관함 화면
│   │   │   ├── DebateModal.js              # 토론 모달
│   │   │   ├── ExchangeDiaryScreen.js      # 교환일기 화면
│   │   │   ├── ReportScreens.js            # 심리 리포트 화면
│   │   │   ├── ReportImageComponent.js     # 리포트 이미지 생성 컴포넌트
│   │   │   ├── StatsScreen.js              # 통계 화면
│   │   │   ├── WeeklyRecapScreen.js        # 주간 리캡 화면
│   │   │   └── WeeklyDetailScreen.js       # 주간 상세 화면
│   │   ├── constants/                # 상수 데이터
│   │   │   ├── characterData.js      # 캐릭터 데이터
│   │   │   ├── chatTemplates.js      # 대화 템플릿
│   │   │   └── debateTopics.js       # 토론 주제
│   │   ├── utils/                    # 유틸리티 함수
│   │   │   ├── api.js                # API 호출 함수
│   │   │   ├── koreanJosa.js         # 한국어 조사 처리
│   │   │   ├── storage.js            # 로컬 스토리지 관리
│   │   │   ├── text.js               # 텍스트 처리 유틸리티
│   │   │   └── reportUtils.js        # 리포트 유틸리티
│   │   ├── App.js                    # 메인 애플리케이션 컴포넌트
│   │   ├── App.css                   # 메인 스타일시트
│   │   ├── base.css                  # 기본 스타일시트
│   │   ├── layout.css                # 레이아웃 스타일시트
│   │   ├── variables.css             # CSS 변수
│   │   └── index.js                  # 진입점
│   ├── public/                       # 정적 파일
│   │   ├── index.html
│   │   └── assets/                   # 이미지, 아이콘 등
│   ├── build/                        # 빌드 결과물
│   ├── package.json                  # Node.js 의존성
│   └── jsconfig.json                 # JavaScript 설정
│
├── start_all.ps1                     # 전체 서버 시작 스크립트 (Windows)
├── README.md                         # 프로젝트 설명서
├── TECH_STACK.md                     # 기술 스택 문서
├── STRUCTURE_SUMMARY.md              # 프로젝트 구조 요약
└── requirements.txt                  # 루트 레벨 requirements.txt (선택사항)
```

---

## 시작하기

### 사전 요구사항

- **Python** 3.8 이상
- **Node.js** 14 이상
- **npm** (Node.js와 함께 설치됨)
- **Google Gemini API 키** ([Google AI Studio](https://makersuite.google.com/app/apikey)에서 발급)

### 설치 및 실행

#### 1. 저장소 클론

```bash
git clone <repository-url>
cd IntoDrama
```

#### 2. 백엔드 설정

```bash
# 백엔드 디렉토리로 이동
cd backend

# 가상환경 생성 (처음 한 번만)
python -m venv venv

# 가상환경 활성화
# Windows PowerShell:
.\venv\Scripts\Activate.ps1
# Windows CMD:
.\venv\Scripts\activate.bat
# Linux/Mac:
source venv/bin/activate

# 의존성 설치
pip install -r requirements.txt

# 환경 변수 설정
# 방법 1: 환경 변수로 설정
$env:GOOGLE_API_KEY = "your-api-key-here"

# 방법 2: .env 파일 생성 (권장)
# backend/.env 파일 생성 후:
GOOGLE_API_KEY=your-api-key-here
WEATHER_API_KEY=your-weather-api-key-here  # 선택사항 (일기 날씨 기능용)
SECRET_KEY=your-secret-key-here            # 선택사항 (JWT 토큰 암호화용)

# 서버 실행
python main.py
# 또는
python -m uvicorn main:app --reload
```

백엔드 서버가 `http://localhost:8000`에서 실행됩니다.

#### 3. 프론트엔드 설정

새 터미널 창을 열고:

```bash
# 프론트엔드 디렉토리로 이동
cd frontend

# 의존성 설치 (처음 한 번만)
npm install

# 개발 서버 실행
npm start
```

프론트엔드 서버가 `http://localhost:3000`에서 실행되고 브라우저가 자동으로 열립니다.

#### 4. 한 번에 시작하기 (Windows)

프로젝트 루트 디렉토리에서:

```powershell
.\start_all.ps1
```

이 스크립트는 백엔드와 프론트엔드를 동시에 실행하고 브라우저를 자동으로 엽니다.

---

## 환경 변수

### 백엔드

`.env` 파일을 `backend/` 디렉토리에 생성하거나 환경 변수로 설정:

- `GOOGLE_API_KEY` (필수): Google Gemini API 키
- `WEATHER_API_KEY` (선택): OpenWeatherMap API 키 (일기 날씨 기능용)
- `SECRET_KEY` (선택): JWT 토큰 암호화 키 (기본값: "your-secret-key-change-in-production")

### 프론트엔드

`.env` 파일을 `frontend/` 디렉토리에 생성:

- `REACT_APP_API_URL`: 백엔드 API 주소 (기본값: http://localhost:8000)

---

## 사용 방법

### 1. 회원가입 및 로그인
- 앱을 실행하면 로그인 화면이 표시됩니다.
- 이메일과 비밀번호로 회원가입 후 로그인합니다.

### 2. 캐릭터 선택
- 메인 화면에서 대화하고 싶은 캐릭터를 선택합니다.
- **1:1 대화**: 1명의 캐릭터를 선택하여 개인 대화를 시작합니다.
- **1:2 멀티채팅**: 최대 2명의 캐릭터를 선택하여 동시에 대화할 수 있습니다 (3명 이상은 지원하지 않습니다).
- 검색 기능을 통해 캐릭터 이름이나 드라마 제목으로 필터링할 수 있습니다.
- 즐겨찾기 기능으로 자주 대화하는 캐릭터를 빠르게 선택할 수 있습니다.

### 3. 대화 시작
- 선택한 캐릭터와 대화를 시작합니다.
- 메시지를 입력하고 전송하면 AI가 캐릭터의 페르소나에 맞게 응답합니다.

### 4. 기능 사용
- **토론 모드**: 2명의 캐릭터를 선택하고 토론 버튼을 클릭하여 토론을 시작합니다.
- **대화 저장**: 대화 중 "서버에 저장" 버튼을 클릭하여 대화를 서버에 저장합니다.
- **대사 저장**: 좋아하는 메시지를 더블클릭하여 하트로 표시하고 저장합니다.
- **일기 생성**: 대화 후 일기 버튼을 클릭하여 AI가 생성한 감정 일기를 확인합니다.
- **교환일기**: 일기 작성 후 "답장 받기" 옵션을 활성화하여 캐릭터와 편지를 교환합니다.
- **음성 입력**: 음성 입력 버튼을 클릭하여 음성으로 메시지를 입력합니다.
- **통계 확인**: 통계 화면에서 주간 대화 통계와 리캡을 확인합니다.
- **심리 리포트**: 대화 후 리포트 버튼을 클릭하여 AI가 분석한 심리 리포트를 확인합니다.
- **성향 지도**: 성향 지도 버튼을 클릭하여 캐릭터들의 성향을 시각적으로 비교합니다.
- **음악 추천**: 음악 추천 기능을 통해 감정에 맞는 음악을 추천받습니다.

---

## 기술 스택

자세한 기술 스택 정보는 [TECH_STACK.md](./TECH_STACK.md)를 참고하세요.

### 주요 기술
- **백엔드**: 
  - FastAPI: 고성능 비동기 웹 프레임워크
  - SQLAlchemy: ORM (Object-Relational Mapping)
  - SQLite: 경량 데이터베이스
  - Google Gemini AI (gemini-2.5-flash): AI 챗봇 엔진
  - APScheduler: 백그라운드 작업 스케줄링 (교환일기 답장 생성 등)
  - Python-dotenv: 환경 변수 관리
  - Passlib: 비밀번호 해싱
  - Python-jose: JWT 토큰 처리
  - Uvicorn: ASGI 서버

- **프론트엔드**: 
  - React 19: 사용자 인터페이스 라이브러리
  - HTML2Canvas: 대화 캡처 기능
  - Recharts: 통계 차트 시각화
  - Web Speech API: 음성 인식 기능
  - Web Audio API: 음성 감정 분석

- **인증**: 
  - JWT (JSON Web Token): 토큰 기반 인증
  - 토큰 만료 시간: 30일
  - HTTP Bearer 토큰 방식

- **데이터베이스**: 
  - SQLite: 로컬 파일 기반 데이터베이스
  - 주요 테이블: users, chat_history, emotion_diary, exchange_diary, character_memory, character_archetype

- **외부 API**:
  - Google Gemini AI API: AI 응답 생성
  - OpenWeatherMap API: 날씨 정보 (선택사항)

---

## API 문서

백엔드 서버가 실행 중일 때 다음 주소에서 API 문서를 확인할 수 있습니다:

- Swagger UI: `http://localhost:8000/docs`
- ReDoc: `http://localhost:8000/redoc`

### 주요 API 엔드포인트

#### 인증 (`/auth`)
- `POST /auth/register`: 회원가입
- `POST /auth/login`: 로그인
- `GET /auth/me`: 현재 사용자 정보 조회
- `PUT /auth/profile`: 프로필 수정 (닉네임, 프로필 사진)

#### 채팅 (`/chat`)
- `POST /chat`: 채팅 메시지 전송 (1:1 또는 멀티채팅)
- `POST /chat/debate`: 토론 시작/진행
- `POST /chat/save`: 대화 저장
- `GET /chat/history`: 저장된 대화 목록 조회
- `GET /chat/history/{chat_id}`: 특정 대화 조회
- `DELETE /chat/history/{chat_id}`: 대화 삭제
- `GET /chat/stats/weekly`: 주간 통계 조회
- `GET /chat/stats/weekly-recap`: 주간 리캡 조회
- `GET /chat/saved-quotes`: 저장된 대사 목록 조회

#### 일기 (`/diary`)
- `POST /diary/generate`: 감정 일기 생성
- `POST /diary/create`: 일기 직접 작성
- `GET /diary/list`: 일기 목록 조회
- `GET /diary/{diary_id}`: 특정 일기 조회
- `DELETE /diary/{diary_id}`: 일기 삭제
- `POST /exchange-diary/create`: 교환일기 생성
- `GET /exchange-diary/list`: 교환일기 목록 조회
- `GET /exchange-diary/{diary_id}`: 교환일기 조회
- `GET /exchange-diary/{diary_id}/reply`: 교환일기 답장 조회
- `POST /exchange-diary/{diary_id}/react`: 답장에 반응하기
- `DELETE /exchange-diary/{diary_id}`: 교환일기 삭제
- `GET /exchange-diary/today-topic`: 오늘의 주제 조회

#### 기타 기능 (`/features`)
- `GET /archetype/map`: 캐릭터 성향 지도 조회
- `POST /music/recommend`: 음악 추천
- `POST /music/character-recommend`: 캐릭터 음악 추천
- `POST /psychology/report`: 심리 리포트 생성

### 데이터베이스 모델

#### Users (사용자)
- `id`: 사용자 ID (Primary Key)
- `email`: 이메일 (Unique)
- `hashed_password`: 해시된 비밀번호
- `nickname`: 닉네임
- `profile_pic`: 프로필 사진 URL
- `created_at`: 생성 시간
- `updated_at`: 수정 시간

#### ChatHistory (대화 기록)
- `id`: 대화 ID (Primary Key)
- `user_id`: 사용자 ID (Foreign Key)
- `character_ids`: 캐릭터 ID 목록 (JSON)
- `messages`: 메시지 목록 (JSON)
- `title`: 대화 제목
- `is_manual`: 수동 저장 여부 (0: 자동, 1: 수동)
- `is_manual_quote`: 대사 저장으로 인한 저장 여부
- `created_at`: 생성 시간
- `updated_at`: 수정 시간

#### EmotionDiary (감정 일기)
- `id`: 일기 ID (Primary Key)
- `user_id`: 사용자 ID (Foreign Key)
- `title`: 일기 제목
- `content`: 일기 내용
- `date`: 일기 날짜
- `weather`: 날씨 정보
- `emotions`: 감정 태그 (JSON)
- `created_at`: 생성 시간
- `updated_at`: 수정 시간

#### ExchangeDiary (교환일기)
- `id`: 교환일기 ID (Primary Key)
- `user_id`: 사용자 ID (Foreign Key)
- `character_id`: 캐릭터 ID
- `diary_id`: 원본 일기 ID (Foreign Key, 선택사항)
- `content`: 편지 내용
- `reply_content`: 답장 내용
- `reply_received`: 답장 수신 여부
- `request_reply`: 답장 요청 여부
- `scheduled_time`: 예약 발송 시간
- `reaction`: 사용자 반응 (JSON)
- `created_at`: 생성 시간
- `reply_created_at`: 답장 생성 시간

#### CharacterMemory (캐릭터 기억)
- `id`: 기억 ID (Primary Key)
- `user_id`: 사용자 ID (Foreign Key)
- `character_id`: 캐릭터 ID
- `memory_type`: 기억 타입 (emotion, event, preference, relationship)
- `content`: 기억 내용
- `context`: 기억의 맥락 (JSON)
- `importance`: 중요도 (1-10)
- `created_at`: 생성 시간
- `last_referenced`: 마지막 참조 시간

#### CharacterArchetype (캐릭터 성향)
- `id`: 성향 ID (Primary Key)
- `character_id`: 캐릭터 ID
- `name`: 캐릭터 이름
- `warmth`: 따뜻함 점수 (0.0-1.0)
- `realism`: 현실성 점수 (0.0-1.0)
- `created_at`: 생성 시간
- `updated_at`: 수정 시간

---

## 문제 해결

### 백엔드 서버가 시작되지 않는 경우
- Python 가상환경이 활성화되어 있는지 확인
- `requirements.txt`의 모든 패키지가 설치되어 있는지 확인
- `GOOGLE_API_KEY` 환경 변수가 설정되어 있는지 확인

### 프론트엔드가 백엔드에 연결되지 않는 경우
- 백엔드 서버가 `http://localhost:8000`에서 실행 중인지 확인
- CORS 설정이 올바른지 확인
- 브라우저 콘솔에서 오류 메시지 확인

### API 호출 오류가 발생하는 경우
- Google Gemini API 키가 유효한지 확인
- API 사용량 제한을 초과하지 않았는지 확인
- 네트워크 연결 상태 확인

---

## 라이선스

MIT

---

## 기여

이슈나 개선 사항이 있으면 이슈를 등록하거나 Pull Request를 보내주세요.
