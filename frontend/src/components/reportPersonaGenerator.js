// 정서적 상태 진단 및 위로 메시지 생성 함수
export const generatePersona = (report) => {
    if (!report) return { 
        title: '지금은 마음의 짐을 잠시 내려놓을 때', 
        summary: '최근 대화에서 다양한 감정이 섞여 있었어요. 많이 힘드셨죠? 지금 이 순간, 당신의 마음을 알아주고 싶어요.', 
        tags: ['#휴식필요', '#마음_챙김', '#따뜻한_위로'] 
    };
    
    const { stats, dominantMood } = report;
    const { romanceScore, comfortScore, conflictScore } = stats;
    
    // 정서적 상태 진단 및 위로 메시지
    let persona = { title: '', summary: '', tags: [] };
    
    // 감정 점수에 따라 더 세밀하게 분류
    const totalScore = romanceScore + comfortScore + conflictScore;
    const romanceRatio = totalScore > 0 ? romanceScore / totalScore : 0;
    const comfortRatio = totalScore > 0 ? comfortScore / totalScore : 0;
    const conflictRatio = totalScore > 0 ? conflictScore / totalScore : 0;
    
    if (conflictScore > 50) {
        // 갈등이 매우 높은 경우
        const variants = [
            {
                title: '지금은 마음의 짐을 잠시 내려놓을 때',
                summary: '최근 대화에서 갈등과 복잡한 감정이 많이 느껴졌어요. 많이 힘드셨죠? 지금은 무리하지 말고 잠시 쉬어도 괜찮아요. 당신의 마음을 알아주고 싶어요.',
                tags: ['#휴식필요', '#스트레스_관리', '#마음_챙김']
            },
            {
                title: '마음이 복잡한 하루',
                summary: '최근 대화를 보니 마음이 복잡하고 혼란스러운 감정이 느껴졌어요. 이런 감정도 당연한 거예요. 지금은 조금만 천천히, 자신을 다독여주세요.',
                tags: ['#감정_정리', '#자기_이해', '#마음_챙김']
            },
            {
                title: '지친 마음에 위로를',
                summary: '최근 대화에서 스트레스와 피로감이 많이 느껴졌어요. 당신은 충분히 노력하고 있어요. 지금은 잠시 멈춰서 자신을 돌봐도 괜찮아요.',
                tags: ['#자기_돌봄', '#휴식필요', '#위로']
            },
            {
                title: '답답한 마음을 풀어내는 시간',
                summary: '최근 대화를 보니 답답하고 억울한 감정이 많이 느껴졌어요. 이런 감정을 느끼는 것 자체가 당신이 살아있다는 증거예요. 지금은 조금만 쉬어도 괜찮아요.',
                tags: ['#감정_인정', '#자기_이해', '#휴식필요']
            },
            {
                title: '혼란스러운 마음, 잠시 멈춤',
                summary: '최근 대화에서 혼란과 갈등이 많이 느껴졌어요. 모든 것이 한 번에 해결되지 않아도 괜찮아요. 지금은 조금만 천천히, 자신에게 친절하게 대해주세요.',
                tags: ['#자기_친절', '#마음_챙김', '#휴식필요']
            },
            {
                title: '무거운 마음을 내려놓는 순간',
                summary: '최근 대화를 보니 마음이 무겁고 힘든 감정이 느껴졌어요. 당신은 혼자가 아니에요. 지금은 조금만 쉬어도 괜찮아요. 당신의 마음을 알아주고 싶어요.',
                tags: ['#위로', '#자기_돌봄', '#마음_챙김']
            }
        ];
        persona = variants[Math.floor(Math.random() * variants.length)];
    } else if (conflictScore > 30) {
        // 갈등이 중간 정도인 경우
        const variants = [
            {
                title: '조금은 복잡한 마음',
                summary: '최근 대화에서 약간의 갈등과 복잡한 감정이 느껴졌어요. 하지만 괜찮아요. 이런 감정도 성장의 과정이에요. 자신을 너무 탓하지 마세요.',
                tags: ['#성장', '#자기_이해', '#마음_챙김']
            },
            {
                title: '마음이 무거운 하루',
                summary: '최근 대화를 보니 마음이 무겁고 답답한 감정이 느껴졌어요. 지금은 조금만 쉬어도 괜찮아요. 당신의 감정을 인정하고 받아들이는 것부터 시작해보세요.',
                tags: ['#감정_인정', '#휴식필요', '#따뜻한_위로']
            },
            {
                title: '약간의 불안, 하지만 괜찮아요',
                summary: '최근 대화에서 약간의 불안과 걱정이 느껴졌어요. 하지만 괜찮아요. 이런 감정을 느끼는 것도 당연한 거예요. 지금은 조금만 천천히, 자신을 돌봐주세요.',
                tags: ['#자기_돌봄', '#마음_챙김', '#안정']
            },
            {
                title: '혼란스러운 감정, 잠시 멈춤',
                summary: '최근 대화를 보니 약간의 혼란과 복잡한 감정이 느껴졌어요. 모든 것이 명확하지 않아도 괜찮아요. 지금은 조금만 쉬어도 괜찮아요.',
                tags: ['#휴식필요', '#자기_이해', '#마음_챙김']
            }
        ];
        persona = variants[Math.floor(Math.random() * variants.length)];
    } else if (comfortScore > 50) {
        // 위로가 매우 높은 경우
        const variants = [
            {
                title: '누군가의 온기가 그리운 날',
                summary: '최근 대화에서 위로와 안정을 찾으려는 마음이 많이 느껴졌어요. 외로움이나 그리움이 느껴지는 하루였나요? 당신의 마음을 알아주고 싶어요.',
                tags: ['#따뜻한_위로', '#공감_필요', '#마음_나누기']
            },
            {
                title: '따뜻한 포옹이 필요한 순간',
                summary: '최근 대화를 보니 따뜻한 위로와 공감을 원하는 마음이 많이 느껴졌어요. 혼자 감당하기 어려운 마음이 있나요? 당신은 혼자가 아니에요.',
                tags: ['#공감', '#위로', '#연결']
            },
            {
                title: '마음의 안식처를 찾는 하루',
                summary: '최근 대화에서 평온과 안정을 찾으려는 마음이 많이 느껴졌어요. 지금 이 순간, 당신의 마음에 따뜻한 위로를 전하고 싶어요.',
                tags: ['#안정', '#위로', '#마음_챙김']
            },
            {
                title: '외로움이 느껴지는 하루',
                summary: '최근 대화를 보니 외로움과 그리움이 많이 느껴졌어요. 혼자라는 느낌이 드는 하루였나요? 당신은 혼자가 아니에요. 지금 이 순간, 당신의 마음을 알아주고 싶어요.',
                tags: ['#외로움', '#위로', '#연결']
            },
            {
                title: '따뜻한 말 한마디가 그리운 날',
                summary: '최근 대화에서 따뜻한 말과 공감을 원하는 마음이 많이 느껴졌어요. 지금은 조금만 쉬어도 괜찮아요. 당신의 마음에 따뜻함을 전하고 싶어요.',
                tags: ['#따뜻함', '#공감', '#위로']
            },
            {
                title: '마음이 허전한 하루',
                summary: '최근 대화를 보니 마음이 허전하고 공허한 감정이 느껴졌어요. 이런 감정도 당연한 거예요. 지금은 조금만 천천히, 자신을 돌봐주세요.',
                tags: ['#자기_돌봄', '#위로', '#마음_챙김']
            },
            {
                title: '안아주고 싶은 마음',
                summary: '최근 대화에서 따뜻한 포옹과 위로를 원하는 마음이 많이 느껴졌어요. 지금 이 순간, 당신의 마음을 감싸주고 싶어요.',
                tags: ['#포옹', '#위로', '#따뜻함']
            }
        ];
        persona = variants[Math.floor(Math.random() * variants.length)];
    } else if (comfortScore > 30) {
        // 위로가 중간 정도인 경우
        const variants = [
            {
                title: '조용한 위로가 필요한 하루',
                summary: '최근 대화에서 약간의 외로움과 그리움이 느껴졌어요. 지금은 조용히 자신을 돌보고, 작은 위로를 찾아보세요. 당신의 마음을 알아주고 싶어요.',
                tags: ['#자기_돌봄', '#위로', '#마음_챙김']
            },
            {
                title: '따뜻한 마음이 그리운 날',
                summary: '최근 대화를 보니 따뜻한 교감과 공감을 원하는 마음이 느껴졌어요. 지금 이 순간, 당신의 마음에 따뜻함을 전하고 싶어요.',
                tags: ['#따뜻함', '#공감', '#연결']
            },
            {
                title: '작은 위로가 필요한 순간',
                summary: '최근 대화에서 약간의 외로움과 그리움이 느껴졌어요. 작은 위로라도 괜찮아요. 지금은 조금만 천천히, 자신을 돌봐주세요.',
                tags: ['#위로', '#자기_돌봄', '#마음_챙김']
            },
            {
                title: '공감이 필요한 하루',
                summary: '최근 대화를 보니 공감과 이해를 원하는 마음이 느껴졌어요. 당신의 마음을 알아주고 싶어요. 지금은 조금만 쉬어도 괜찮아요.',
                tags: ['#공감', '#이해', '#마음_챙김']
            }
        ];
        persona = variants[Math.floor(Math.random() * variants.length)];
    } else if (romanceScore > 50) {
        // 로맨스가 매우 높은 경우
        const variants = [
            {
                title: '따뜻한 감정이 흐르는 순간',
                summary: '최근 대화에서 따뜻한 감정과 교감을 나누려는 마음이 많이 느껴졌어요. 지금 이 순간의 감정을 소중히 여기고, 당신의 마음을 알아주고 싶어요.',
                tags: ['#감정_인정', '#따뜻한_교감', '#마음_챙김']
            },
            {
                title: '사랑이 피어나는 하루',
                summary: '최근 대화를 보니 따뜻하고 부드러운 감정이 많이 느껴졌어요. 이런 감정은 정말 소중한 거예요. 지금 이 순간을 충분히 즐기고 느껴보세요.',
                tags: ['#사랑', '#감정_인정', '#소중함']
            },
            {
                title: '마음이 설레는 순간',
                summary: '최근 대화에서 설렘과 기대감이 많이 느껴졌어요. 이런 감정은 삶을 더 풍요롭게 만들어요. 지금 이 순간의 감정을 소중히 여기세요.',
                tags: ['#설렘', '#기대', '#감정_인정']
            },
            {
                title: '따뜻한 마음이 뛰는 하루',
                summary: '최근 대화를 보니 따뜻하고 설레는 감정이 많이 느껴졌어요. 이런 감정은 정말 아름다운 거예요. 지금 이 순간을 충분히 즐기고 느껴보세요.',
                tags: ['#설렘', '#감정_인정', '#아름다움']
            },
            {
                title: '사랑의 감정이 흐르는 순간',
                summary: '최근 대화에서 사랑과 따뜻함이 많이 느껴졌어요. 이런 감정은 당신의 마음을 더 풍요롭게 만들어요. 지금 이 순간의 감정을 소중히 여기세요.',
                tags: ['#사랑', '#따뜻함', '#감정_인정']
            },
            {
                title: '마음이 두근거리는 하루',
                summary: '최근 대화를 보니 두근거림과 설렘이 많이 느껴졌어요. 이런 감정은 정말 소중한 거예요. 지금 이 순간을 충분히 즐겨보세요.',
                tags: ['#설렘', '#두근거림', '#소중함']
            },
            {
                title: '따뜻한 교감이 흐르는 순간',
                summary: '최근 대화에서 따뜻한 교감과 감정이 많이 느껴졌어요. 이런 감정은 삶을 더 아름답게 만들어요. 당신의 마음을 알아주고 싶어요.',
                tags: ['#교감', '#따뜻함', '#아름다움']
            }
        ];
        persona = variants[Math.floor(Math.random() * variants.length)];
    } else if (romanceScore > 30) {
        // 로맨스가 중간 정도인 경우
        const variants = [
            {
                title: '따뜻한 감정의 하루',
                summary: '최근 대화에서 따뜻하고 긍정적인 감정이 느껴졌어요. 이런 감정은 당신의 마음을 더 풍요롭게 만들어요. 지금 이 순간을 즐겨보세요.',
                tags: ['#긍정', '#감정_인정', '#마음_챙김']
            },
            {
                title: '마음이 따뜻해지는 순간',
                summary: '최근 대화를 보니 따뜻한 교감과 감정이 느껴졌어요. 이런 감정은 정말 소중한 거예요. 당신의 마음을 알아주고 싶어요.',
                tags: ['#따뜻함', '#교감', '#소중함']
            },
            {
                title: '부드러운 감정이 흐르는 하루',
                summary: '최근 대화에서 부드럽고 따뜻한 감정이 느껴졌어요. 이런 감정은 당신의 마음을 더 아름답게 만들어요. 지금 이 순간을 소중히 여기세요.',
                tags: ['#따뜻함', '#감정_인정', '#아름다움']
            },
            {
                title: '긍정적인 감정이 느껴지는 순간',
                summary: '최근 대화를 보니 긍정적이고 따뜻한 감정이 느껴졌어요. 이런 감정은 정말 소중한 거예요. 당신의 마음을 알아주고 싶어요.',
                tags: ['#긍정', '#따뜻함', '#소중함']
            }
        ];
        persona = variants[Math.floor(Math.random() * variants.length)];
    } else {
        // 평온하지만 피로감이 있는 경우
        const variants = [
            {
                title: '조용히 쉬어도 좋은 하루',
                summary: '최근 대화에서 평온하지만 어딘가 지친 마음이 느껴졌어요. 지금은 조용히 쉬어도 괜찮아요. 당신의 마음을 알아주고 싶어요.',
                tags: ['#휴식필요', '#마음_챙김', '#따뜻한_위로']
            },
            {
                title: '평온한 하루, 조용한 마음',
                summary: '최근 대화를 보니 평온하지만 약간의 피로감이 느껴졌어요. 지금은 무리하지 말고 자신을 돌보는 시간을 가져보세요. 작은 휴식도 충분히 의미 있어요.',
                tags: ['#자기_돌봄', '#휴식', '#마음_챙김']
            },
            {
                title: '여유롭게 쉬어가는 하루',
                summary: '최근 대화에서 평온하고 안정적인 감정이 느껴졌어요. 지금은 조금만 천천히, 자신을 돌보는 시간을 가져보세요. 당신의 마음을 알아주고 싶어요.',
                tags: ['#안정', '#자기_돌봄', '#마음_챙김']
            },
            {
                title: '조용한 하루, 작은 휴식',
                summary: '최근 대화를 보니 평온하지만 약간의 지침이 느껴졌어요. 지금은 조금만 쉬어도 괜찮아요. 작은 휴식도 충분히 의미 있어요.',
                tags: ['#휴식', '#마음_챙김', '#자기_돌봄']
            },
            {
                title: '평온한 마음, 작은 여유',
                summary: '최근 대화에서 평온하고 안정적인 감정이 느껴졌어요. 지금은 조금만 천천히, 자신을 돌보는 시간을 가져보세요. 당신의 마음을 알아주고 싶어요.',
                tags: ['#안정', '#여유', '#마음_챙김']
            },
            {
                title: '조용한 하루, 따뜻한 마음',
                summary: '최근 대화를 보니 평온하고 따뜻한 감정이 느껴졌어요. 지금은 조금만 천천히, 자신을 돌보는 시간을 가져보세요. 작은 휴식도 충분히 의미 있어요.',
                tags: ['#따뜻함', '#휴식', '#마음_챙김']
            }
        ];
        persona = variants[Math.floor(Math.random() * variants.length)];
    }
    
    return persona;
};

